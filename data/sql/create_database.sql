/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE='+00:00' */;
/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

CREATE TABLE vehicle (id INT NOT NULL, fuel INT NOT NULL, transmission INT NOT NULL, currency_id INT NOT NULL, registration_date SMALLINT DEFAULT 0 NOT NULL COMMENT 'Registration year', volume NUMERIC(20, 2) DEFAULT '0' NOT NULL COMMENT 'engine volume', mileage INT NOT NULL, amount NUMERIC(20, 2) NOT NULL, INDEX IDX_1B80E48631BD6FE9 (fuel), INDEX IDX_1B80E4867F87199F (transmission), INDEX IDX_1B80E48638248176 (currency_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE vehicle_options (vehicle_id INT NOT NULL, equipment_id INT NOT NULL, INDEX IDX_CF46A7E8545317D1 (vehicle_id), INDEX IDX_CF46A7E8517FE9FE (equipment_id), PRIMARY KEY(vehicle_id, equipment_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE vehicle_tags (vehicle_id INT NOT NULL, tag_id INT NOT NULL, INDEX IDX_1D21A77A545317D1 (vehicle_id), INDEX IDX_1D21A77ABAD26311 (tag_id), PRIMARY KEY(vehicle_id, tag_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE taxonomies (id INT AUTO_INCREMENT NOT NULL, parent_id INT DEFAULT NULL, name VARCHAR(255) NOT NULL, description LONGTEXT DEFAULT NULL, active TINYINT(1) DEFAULT NULL, created DATETIME NOT NULL, updated DATETIME NOT NULL, list_index INT NOT NULL, tree VARCHAR(255) NOT NULL, INDEX IDX_232B80F9727ACA70 (parent_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE documents (id INT AUTO_INCREMENT NOT NULL, condition_id INT NOT NULL, meta_name VARCHAR(255) DEFAULT NULL, meta_description LONGTEXT DEFAULT NULL, meta_keywords LONGTEXT DEFAULT NULL, name VARCHAR(255) NOT NULL, description LONGTEXT DEFAULT NULL, active TINYINT(1) DEFAULT NULL, created DATETIME NOT NULL, updated DATETIME NOT NULL, list_index INT NOT NULL, doctype VARCHAR(255) NOT NULL, INDEX IDX_A2B07288887793B6 (condition_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE documents_files (document_id INT NOT NULL, file_id INT NOT NULL, INDEX IDX_3A724E4BC33F7837 (document_id), INDEX IDX_3A724E4B93CB796C (file_id), PRIMARY KEY(document_id, file_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE documents_taxonomies (document_id INT NOT NULL, taxonomy_id INT NOT NULL, INDEX IDX_DFF2D192C33F7837 (document_id), INDEX IDX_DFF2D1929557E6F6 (taxonomy_id), PRIMARY KEY(document_id, taxonomy_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE vocabulary (id INT AUTO_INCREMENT NOT NULL, locale INT NOT NULL, term VARCHAR(255) NOT NULL, translation LONGTEXT NOT NULL, INDEX IDX_9099C97B4180C698 (locale), UNIQUE INDEX UNIQ_9099C97B4180C698A50FE78D (locale, term), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE locales (id INT AUTO_INCREMENT NOT NULL, currency_id INT NOT NULL, iso VARCHAR(5) DEFAULT NULL, iso_short VARCHAR(2) DEFAULT NULL, `default` INT NOT NULL, name VARCHAR(255) NOT NULL, description LONGTEXT DEFAULT NULL, active TINYINT(1) DEFAULT NULL, created DATETIME NOT NULL, updated DATETIME NOT NULL, list_index INT NOT NULL, UNIQUE INDEX UNIQ_E59B54BB61587F41 (iso), UNIQUE INDEX UNIQ_E59B54BBFD3A54B3 (iso_short), UNIQUE INDEX UNIQ_E59B54BB38248176 (currency_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE currencies (id INT AUTO_INCREMENT NOT NULL, iso_code VARCHAR(3) NOT NULL, html_code VARCHAR(10) NOT NULL, rate NUMERIC(20, 6) NOT NULL, name VARCHAR(255) NOT NULL, description LONGTEXT DEFAULT NULL, active TINYINT(1) DEFAULT NULL, created DATETIME NOT NULL, updated DATETIME NOT NULL, list_index INT NOT NULL, UNIQUE INDEX UNIQ_37C4469362B6A45E (iso_code), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE conditions (id INT AUTO_INCREMENT NOT NULL, name VARCHAR(255) NOT NULL, description LONGTEXT DEFAULT NULL, active TINYINT(1) DEFAULT NULL, created DATETIME NOT NULL, updated DATETIME NOT NULL, list_index INT NOT NULL, entity_type VARCHAR(255) NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE files (id INT AUTO_INCREMENT NOT NULL, name VARCHAR(255) NOT NULL, description LONGTEXT DEFAULT NULL, hash VARCHAR(32) NOT NULL, mime VARCHAR(64) NOT NULL, size INT DEFAULT NULL, active TINYINT(1) DEFAULT NULL, list_index INT NOT NULL, created DATETIME NOT NULL, updated DATETIME NOT NULL, UNIQUE INDEX UNIQ_6354059D1B862B8 (hash), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE roles (id INT AUTO_INCREMENT NOT NULL, name VARCHAR(48) NOT NULL, UNIQUE INDEX UNIQ_B63E2EC75E237E06 (name), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE role_role (role_source INT NOT NULL, role_target INT NOT NULL, INDEX IDX_E9D6F8FEF4AC9EC2 (role_source), INDEX IDX_E9D6F8FEED49CE4D (role_target), PRIMARY KEY(role_source, role_target)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE role_permission (role_id INT NOT NULL, permission_id INT NOT NULL, INDEX IDX_6F7DF886D60322AC (role_id), INDEX IDX_6F7DF886FED90CCA (permission_id), PRIMARY KEY(role_id, permission_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE permissions (id INT AUTO_INCREMENT NOT NULL, name VARCHAR(128) NOT NULL, UNIQUE INDEX UNIQ_2DEDCC6F5E237E06 (name), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE managers (id INT AUTO_INCREMENT NOT NULL, username VARCHAR(255) NOT NULL, email VARCHAR(255) NOT NULL, display_name VARCHAR(50) DEFAULT NULL, password VARCHAR(128) NOT NULL, state SMALLINT DEFAULT NULL, UNIQUE INDEX UNIQ_A949E006F85E0677 (username), UNIQUE INDEX UNIQ_A949E006E7927C74 (email), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE manager_role (manager_id INT NOT NULL, role_id INT NOT NULL, INDEX IDX_51602813783E3463 (manager_id), INDEX IDX_51602813D60322AC (role_id), PRIMARY KEY(manager_id, role_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
ALTER TABLE vehicle ADD CONSTRAINT FK_1B80E48631BD6FE9 FOREIGN KEY (fuel) REFERENCES taxonomies (id);
ALTER TABLE vehicle ADD CONSTRAINT FK_1B80E4867F87199F FOREIGN KEY (transmission) REFERENCES taxonomies (id);
ALTER TABLE vehicle ADD CONSTRAINT FK_1B80E48638248176 FOREIGN KEY (currency_id) REFERENCES currencies (id);
ALTER TABLE vehicle ADD CONSTRAINT FK_1B80E486BF396750 FOREIGN KEY (id) REFERENCES documents (id) ON DELETE CASCADE;
ALTER TABLE vehicle_options ADD CONSTRAINT FK_CF46A7E8545317D1 FOREIGN KEY (vehicle_id) REFERENCES vehicle (id) ON DELETE CASCADE;
ALTER TABLE vehicle_options ADD CONSTRAINT FK_CF46A7E8517FE9FE FOREIGN KEY (equipment_id) REFERENCES taxonomies (id) ON DELETE CASCADE;
ALTER TABLE vehicle_tags ADD CONSTRAINT FK_1D21A77A545317D1 FOREIGN KEY (vehicle_id) REFERENCES vehicle (id) ON DELETE CASCADE;
ALTER TABLE vehicle_tags ADD CONSTRAINT FK_1D21A77ABAD26311 FOREIGN KEY (tag_id) REFERENCES taxonomies (id) ON DELETE CASCADE;
ALTER TABLE taxonomies ADD CONSTRAINT FK_232B80F9727ACA70 FOREIGN KEY (parent_id) REFERENCES taxonomies (id);
ALTER TABLE documents ADD CONSTRAINT FK_A2B07288887793B6 FOREIGN KEY (condition_id) REFERENCES conditions (id);
ALTER TABLE documents_files ADD CONSTRAINT FK_3A724E4BC33F7837 FOREIGN KEY (document_id) REFERENCES documents (id) ON DELETE CASCADE;
ALTER TABLE documents_files ADD CONSTRAINT FK_3A724E4B93CB796C FOREIGN KEY (file_id) REFERENCES files (id) ON DELETE CASCADE;
ALTER TABLE documents_taxonomies ADD CONSTRAINT FK_DFF2D192C33F7837 FOREIGN KEY (document_id) REFERENCES documents (id) ON DELETE CASCADE;
ALTER TABLE documents_taxonomies ADD CONSTRAINT FK_DFF2D1929557E6F6 FOREIGN KEY (taxonomy_id) REFERENCES taxonomies (id) ON DELETE CASCADE;
ALTER TABLE vocabulary ADD CONSTRAINT FK_9099C97B4180C698 FOREIGN KEY (locale) REFERENCES locales (id);
ALTER TABLE locales ADD CONSTRAINT FK_E59B54BB38248176 FOREIGN KEY (currency_id) REFERENCES currencies (id);
ALTER TABLE role_role ADD CONSTRAINT FK_E9D6F8FEF4AC9EC2 FOREIGN KEY (role_source) REFERENCES roles (id) ON DELETE CASCADE;
ALTER TABLE role_role ADD CONSTRAINT FK_E9D6F8FEED49CE4D FOREIGN KEY (role_target) REFERENCES roles (id) ON DELETE CASCADE;
ALTER TABLE role_permission ADD CONSTRAINT FK_6F7DF886D60322AC FOREIGN KEY (role_id) REFERENCES roles (id) ON DELETE CASCADE;
ALTER TABLE role_permission ADD CONSTRAINT FK_6F7DF886FED90CCA FOREIGN KEY (permission_id) REFERENCES permissions (id) ON DELETE CASCADE;
ALTER TABLE manager_role ADD CONSTRAINT FK_51602813783E3463 FOREIGN KEY (manager_id) REFERENCES managers (id) ON DELETE CASCADE;
ALTER TABLE manager_role ADD CONSTRAINT FK_51602813D60322AC FOREIGN KEY (role_id) REFERENCES roles (id) ON DELETE CASCADE;

/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */;
/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;
